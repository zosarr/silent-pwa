<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Silent PWA</title>

    <!-- PWA meta -->
    <meta name="theme-color" content="#111111">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Silent">

    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="./icons/1.png">

    <link rel="stylesheet" href="styles.css" />
</head>

<body>

<!-- INSTALL BANNER iOS -->
<div id="iosInstallBanner" class="ios-banner" style="display:none;">
    <div class="ios-banner-content">
        <h3>Installa Silent</h3>
        <p>Per installare l'app su iPhone: premi <strong>Condividi</strong> ‚Üí <strong>Aggiungi a Home</strong>.</p>
        <div class="ios-banner-buttons">
            <button id="iosInstallClose">Non ora</button>
            <button id="iosInstallNever">Non mostrare pi√π</button>
        </div>
    </div>
</div>

<!-- HEADER -->
<header class="app-header glass">
    <div class="brand">
        <img src="./icons/1.png" class="brand-icon">
        <span class="brand-title" data-i18n="title">Silent</span>
    </div>

    <div class="top-right-controls">
        <select id="langSel">
            <option value="it">IT</option>
            <option value="en">EN</option>
        </select>
        <span id="connState" class="conn-state">‚óè offline</span>
    </div>
</header>

<!-- MAIN -->
<main>

    <!-- SESSION AREA -->
    <section class="session-box glass">
        <h2 data-i18n="sessionTitle">Connessione diretta (E2E)</h2>

        <div class="session-row">
            <label data-i18n="yourKey">Tua chiave pubblica</label>
            <textarea id="myPub" readonly></textarea>
        </div>

        <div class="session-row">
            <label data-i18n="peerKey">Chiave pubblica del partner</label>
            <textarea id="peerPub" placeholder="Incolla la chiave del partner"></textarea>
        </div>

        <div class="session-actions">
            <button id="startBtn" class="primary-btn" data-i18n="startSession">Avvia sessione</button>
            <button id="copyMyKey" class="secondary-btn" data-i18n="copyKey">Copia la mia chiave</button>
        </div>

        <p data-i18n="sessionHint" class="hint">
            Incolla la chiave del tuo partner e clicca Avvia Sessione.
        </p>
    </section>

    <!-- CHAT -->
    <section class="chat-box glass">
        <ul id="log"></ul>

        <div class="composer">
            <textarea id="textInput" rows="2" placeholder="Scrivi un messaggio..." data-i18n-placeholder="writeMessage"></textarea>
            <div class="composer-buttons">
                <button id="sendBtn" class="primary-btn" data-i18n="send">Invia</button>
                <button id="photoBtn" class="secondary-btn">üì∑</button>
                <button id="audioBtn" class="secondary-btn">üé§</button>
            </div>
        </div>
    </section>

</main>

<!-- LICENSE OVERLAY -->
<div id="licenseOverlay" class="license-overlay" style="display:none;">
    <div class="license-modal">
        <h2 id="licenseTitle">Licenza PRO</h2>

        <p id="licenseMessage"></p>
        <p id="licenseCountdown"></p>

        <img id="licenseQr" class="qr-image" alt="QR Payment">
        <p id="licenseAddr" class="btc-address"></p>
        <p id="licenseAmount" class="btc-amount"></p>

        <div class="license-buttons">
            <button id="licenseBuyBtn" class="primary-btn">Paga in Bitcoin</button>
            <button id="licenseDemoBtn" class="secondary-btn">Continua in DEMO</button>
        </div>
    </div>
</div>

<!-- PHOTO MENU OVERLAY -->
<div id="photoMenu" class="photo-menu" style="display:none;">
    <div class="photo-menu-box glass">
        <button id="takePhotoBtn" class="primary-btn">Scatta foto</button>
        <button id="choosePhotoBtn" class="primary-btn">Scegli dalla galleria</button>
        <button id="closePhotoMenu" class="secondary-btn">Annulla</button>
    </div>
</div>

<!-- FILE INPUTS -->
<input type="file" id="cameraInput" accept="image/*" capture="environment" style="display:none;">
<input type="file" id="galleryInput" accept="image/*" style="display:none;">
<input type="file" id="audioInput" accept="audio/*" style="display:none;">


<script type="module" src="i18n.js"></script>
<script type="module" src="crypto.js"></script>
<script type="module" src="app.js"></script>

</body>
</html>
